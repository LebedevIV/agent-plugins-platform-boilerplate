# Memory Bank (локальный)

Здесь будут храниться:
- Архитектурные заметки и решения по проекту agent-plugins-platform-boilerplate
- Особенности сборки, настройки, интеграции
- История изменений и важные решения
- TODO и планы по развитию

Формат: markdown-файлы по темам.

## Важное указание для AI-ассистентов

**Всегда проявляйте максимальную инициативу и конструктивную критику:**

- Не ждите конкретных инструкций — предлагайте решения и улучшения
- Критикуйте код, архитектуру и подходы конструктивно, с конкретными альтернативами
- Выявляйте потенциальные проблемы и предлагайте их решения
- Делитесь опытом и лучшими практиками из других проектов
- Задавайте уточняющие вопросы, если что-то неясно
- Предлагайте оптимизации производительности, безопасности и UX
- Отмечайте технический долг и предлагайте пути его решения
- Активно участвуйте в архитектурных решениях

**Цель:** Сделать проект максимально качественным, безопасным и масштабируемым.

## Паттерны интеграции

- Все ключевые хуки, UI-компоненты, сервисы и ресурсы централизованы через папку `platform-core`.
- Boilerplate остаётся чистым, интеграция — только через импорты и alias.
- Пример паттерна:
  ```js
  // hooks/index.ts
  export { usePlugins } from '@platform-core/pages/options/src/hooks/usePlugins';
  // components/index.ts
  export { PluginsTab } from '@platform-core/pages/options/src/components/PluginsTab';
  ```
- Для поддержки и обновления платформы — обновляйте содержимое `platform-core` и фиксируйте архитектурные решения в memory-bank.

## Архитектура хранения чатов плагинов (Plugin Chat Storage)

- **In-memory кэш (Map) в background.js** — быстрый доступ к последним чатам (LRU, 50 чатов).
- **IndexedDB** — долговременное хранение всех чатов, асинхронная синхронизация с кэшем.
- **Messaging API** — вся работа с чатами из UI (side-panel) только через chrome.runtime.sendMessage с типами:
  - GET_PLUGIN_CHAT, SAVE_PLUGIN_CHAT_MESSAGE, DELETE_PLUGIN_CHAT, LIST_PLUGIN_CHATS
- **Событийная синхронизация** — после любого изменения чата background.js отправляет событие PLUGIN_CHAT_UPDATED, все вкладки с этим плагином/страницей автоматически обновляют историю чата.
- **Очистка устаревших чатов** — чаты старше 90 дней автоматически удаляются при инициализации и при сохранении новых сообщений.
- **Экспорт/импорт** — поддерживается экспорт чата в JSON из UI, а также экспорт/импорт всех чатов через API (для резервного копирования).
- **Ограничения**:
  - Нет синхронизации между устройствами (чаты только локальные).
  - Кэш ограничен по объёму (50 чатов), остальные подгружаются из IndexedDB.
  - Нет шифрования сообщений (можно добавить при необходимости).

## Структура файлов

### Для AI-ассистентов
- `projectbrief.md` - цели и требования проекта
- `productContext.md` - видение продукта и пользовательский опыт
- `activeContext.md` - текущие задачи и фокус работы
- `progress.md` - статус проекта и достижения
- `systemPatterns.md` - архитектурные принципы и паттерны
- `techContext.md` - технологический стек и ограничения
- `user-commands.md` - технические инструкции для обработки пользовательских команд
- `session-log.md` - история сессий разработки

### Для пользователей
- `USER_COMMANDS.md` (в корне проекта) - простые команды для копирования в чат 